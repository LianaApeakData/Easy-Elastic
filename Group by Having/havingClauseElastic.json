"GET /trainstations/_search"{
   "size":0,
   "aggregations":{
      "groupby":{
         "composite":{
            "size":100,
            "sources":[
               {
                  "countries":{
                     "terms":{
                        "field":"country.keyword",
                        "missing_bucket":true,
                        "order":"asc"
                     }
                  }
               }
            ]
         },
         "aggs":{
            "minor_stations":{
               "filter":{
                  "terms":{
                     "is_main_station.keyword":[
                        "FALSE"
                     ]
                  }
               },
               "aggs":{
                  "count":{
                     "value_count":{
                        "field":"name.keyword"
                     }
                  }
               }
            },
            "having":{
               "bucket_selector":{
                  "buckets_path":{
                     "count_path":"minor_stations>count"
                  },
                  "script":{
                     "source":"params.count_path>1000",
                     "lang":"painless"
                  },
                  "gap_policy":"skip"
               }
            }
         }
      }
   }
}
